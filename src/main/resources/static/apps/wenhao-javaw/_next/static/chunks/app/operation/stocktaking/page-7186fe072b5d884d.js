(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{2331:function(e,t,n){Promise.resolve().then(n.bind(n,7163))},1641:function(e,t,n){"use strict";n.d(t,{R1:function(){return AddWarehouses},N6:function(){return addInboundRecord},_R:function(){return addMaterial},X:function(){return addMaterialRFID},Kk:function(){return addOutboundRecord},tR:function(){return addStocktakingRecord},UT:function(){return addStorageLocation},Gs:function(){return deleteInbound},Gx:function(){return deleteMaterial},jA:function(){return deleteOutbound},Ap:function(){return deleteStocktaking},zf:function(){return deleteStorageLocation},x0:function(){return deleteWarehouse},z2:function(){return fetchInbound},hU:function(){return fetchInboundDetails},nW:function(){return fetchInboundWithFilter},v0:function(){return fetchMaterial},aG:function(){return fetchMaterialRFID},hI:function(){return fetchMaterialWithFilters},eB:function(){return fetchOutbound},NE:function(){return fetchOutboundDetails},Ju:function(){return fetchOutboundWithFilter},eN:function(){return fetchStocktaking},DP:function(){return fetchStocktakingDetails},_b:function(){return fetchStocktakingWithFilter},$_:function(){return fetchStorageLocationsByWId},tV:function(){return fetchWarehouses},_U:function(){return fetchWarehousesWithFilters},VR:function(){return updateMaterial},qL:function(){return updateWarehouse}});var a=n(2173),o=n(1490);n(2601);let r=a.Z.create({baseURL:"/wmsbackendapi",withCredentials:!0,timeout:1e5});function removeLoginInfo(){o.Z.remove("isv_token")}async function fetchWarehouses(e,t){return r.post("/wms/warehouse/get",{},{params:{pageNum:e,pageSize:t}}).then(e=>(console.log(e),e.data.data))}async function fetchWarehousesWithFilters(e){return r.post("/wms/warehouse/get",e).then(e=>(console.log(e),e.data.data))}async function AddWarehouses(e){return r.post("/wms/warehouse/add",e).then(e=>console.log(e))}async function deleteWarehouse(e){return r.post("/wms/warehouse/delete",{id:e}).then(e=>console.log(e))}async function updateWarehouse(e){return r.post("/wms/warehouse/update",e).then(e=>console.log(e))}async function fetchStorageLocationsByWId(e){return r.post("/wms/storagelocation/get",e).then(e=>(console.log(e),e.data.data))}async function addStorageLocation(e){return r.post("/wms/storagelocation/add",e).then(e=>(console.log(e),e.data.data))}async function deleteStorageLocation(e){return r.post("/wms/storagelocation/delete",e).then(e=>(console.log(e),e.data.data))}async function fetchMaterial(){return r.post("/wms/material/get").then(e=>(console.log(e),e.data.data))}async function fetchMaterialWithFilters(e){return r.post("/wms/material/get",e).then(e=>(console.log(e),e.data.data))}async function addMaterial(e){return r.post("/wms/material/add",e).then(e=>(console.log(e),e.data.data))}async function updateMaterial(e){return r.post("/wms/material/update",e).then(e=>(console.log(e),e.data.data))}async function deleteMaterial(e){return r.post("/wms/material/delete",e).then(e=>(console.log(e),e.data.data))}async function fetchMaterialRFID(){return r.post("/wms/rfidmaterial/get").then(e=>(console.log(e),e.data.data))}async function addMaterialRFID(e){return r.post("/wms/rfidmaterial/add",e).then(e=>(console.log(e),e.data.data))}async function addInboundRecord(e){return r.post("/wms/inbound/add",e).then(e=>(console.log(e),e.data.data))}async function fetchInbound(){return r.post("/wms/inbound/get").then(e=>(console.log(e),e.data.data))}async function fetchInboundWithFilter(e){return r.post("/wms/inbound/get",e).then(e=>(console.log(e),e.data.data))}async function deleteInbound(e){return r.post("/wms/inbound/delete",e).then(e=>(console.log(e),e.data.data))}async function fetchInboundDetails(e){return r.post("/wms/inbound/detail/get",e).then(e=>(console.log(e),e.data.data))}async function addOutboundRecord(e){return r.post("/wms/outbound/add",e).then(e=>(console.log(e),e.data.data))}async function fetchOutbound(){return r.post("/wms/outbound/get").then(e=>(console.log(e),e.data.data))}async function fetchOutboundWithFilter(e){return r.post("/wms/outbound/get",e).then(e=>(console.log(e),e.data.data))}async function deleteOutbound(e){return r.post("/wms/outbound/delete",e).then(e=>(console.log(e),e.data.data))}async function fetchOutboundDetails(e){return r.post("/wms/outbound/detail/get",e).then(e=>(console.log(e),e.data.data))}async function addStocktakingRecord(e){return r.post("/wms/stocktaking/add",e).then(e=>(console.log(e),e.data.data))}async function fetchStocktaking(){return r.post("/wms/stocktaking/get").then(e=>(console.log(e),e.data.data))}async function fetchStocktakingWithFilter(e){return r.post("/wms/stocktaking/get",e).then(e=>(console.log(e),e.data.data))}async function deleteStocktaking(e){return r.post("/wms/stocktaking/delete",e).then(e=>(console.log(e),e.data.data))}async function fetchStocktakingDetails(e){return r.post("/wms/stocktaking/detail/get",e).then(e=>(console.log(e),e.data.data))}r.interceptors.request.use(e=>(null!=o.Z.get("isv_token")&&(e.headers.userToken=o.Z.get("isv_token")),e),e=>Promise.reject(e)),r.interceptors.response.use(function(e){return 401===e.data.code?(removeLoginInfo(),Promise.reject()):e},function(e){return(console.log(e),401===e.response.status)?(removeLoginInfo(),Promise.reject()):Promise.reject(e)})},7163:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return page}});var a=n(7437),o=n(2265),r=n(5461),s=n(6302),i=n(1005),c=n(8108),l=n(5097),d=n(2107);n(3180);var u=n(1641);let h=[{key:"material_name",header:"Material Name"},{key:"quantity",header:"Quantity"},{key:"stock_quantity",header:"Stock Quantity"},{key:"discrepancy",header:"Discrepancy"}];var Modal_StocktakingResultModal=function(e){let{isModalOpen:t,setModalOpen:n,material:o}=e,s=o.reduce((e,t)=>{let{storage_location:n}=t;return e[n]||(e[n]=[]),e[n].push(...t.inventory),e},{}),i=Object.keys(s);return console.log(s),(0,a.jsxs)(r.u_l,{open:t,modalHeading:"Result",passiveModal:!0,onRequestClose:()=>n(!1),size:"lg",children:[(0,a.jsx)(r.X6q,{className:"text-sm font-normal leading-tight tracking-tight mb-3",children:"The following products entered the designated warehouse in this inbound task."}),0!==i.length&&(0,a.jsxs)(r.mQc,{children:[(0,a.jsx)(r.tdY,{"aria-label":"List of tabs",contained:!0,children:i.map((e,t)=>(0,a.jsx)(r.OK9,{children:e},t))}),(0,a.jsx)(r.nPR,{children:i.map((e,t)=>(0,a.jsx)(r.x45,{children:(0,a.jsx)(r.wQF,{rows:s[e],headers:h,render:t=>{let{headers:n,getHeaderProps:o}=t;return(0,a.jsx)(r.xJi,{children:(0,a.jsxs)(r.iA_,{children:[(0,a.jsx)(r.ssF,{children:(0,a.jsx)(r.SCH,{children:n.map(e=>(0,a.jsx)(r.xDH,{...o({header:e}),children:e.header},e))})}),(0,a.jsx)(r.RMI,{children:s[e].map((e,t)=>(0,a.jsx)(r.SCH,{children:n.map(t=>"discrepancy"===t.key?(0,a.jsx)(r.pj1,{children:(0,a.jsx)(r.Vp9,{type:0>parseInt(e[t.key])?"red":0===parseInt(e[t.key])?"blue":"green",children:e[t.key]})},t.key):(0,a.jsx)(r.pj1,{children:e[t.key]},t.key))},t))})]})})}})},t))})]})]})},Table_StocktakingTable=function(e){let{headers:t,rows:n,setRefresh:s}=e,[i,c]=(0,o.useState)(1),[h,f]=(0,o.useState)(10),[g,k]=o.useState(!1),handleDeleteRow=async e=>{(0,u.Ap)({id:e}).then(()=>s({}))},[x,m]=(0,o.useState)([]),[p,y]=(0,o.useState)({});(0,o.useEffect)(()=>{let fetchDetails=async()=>{let e=await Promise.all(n.map(async e=>{console.log({id:e.id,ref_id:e.ref_id});let t=await (0,u.DP)({id:e.id,ref_id:e.ref_id}),n=[...new Set(t.map(e=>e.storage_location))].join(", ");return{...e,storage_location:n,material:t}}));y(e.reduce((e,t)=>(e[t.id]=t,e),{}))};fetchDetails()},[n]),console.log(p);let[j,b]=(0,o.useState)("create_time"),[w,S]=(0,o.useState)("desc"),v=o.useMemo(()=>{if(!j)return n;let e=[...n];return e.sort((e,t)=>e[j]<t[j]?"asc"===w?-1:1:e[j]>t[j]?"asc"===w?1:-1:0),e},[n,j,w]),F=v.slice((i-1)*h,i*h),handleSort=e=>{j===e?S("asc"===w?"desc":"asc"):(b(e),S("asc"))};return(0,a.jsxs)("div",{children:[(0,a.jsxs)(r.x4x,{isCondensed:!0,children:[(0,a.jsx)(r.SmK,{children:(0,a.jsx)(r.s1N,{head:!0,children:t.map((e,t)=>(0,a.jsxs)(r.agF,{head:!0,onClick:()=>handleSort(e.key),children:[e.header,j===e.key&&(0,a.jsx)("span",{children:"asc"===w?" ▲":" ▼"})]},e.key))})}),(0,a.jsx)(r.FxI,{children:F.map((e,n)=>(0,a.jsxs)(r.s1N,{children:[t.map(t=>{if("status"===t.key)return(0,a.jsx)(r.agF,{children:(0,a.jsx)(r.Vp9,{type:"blue",children:""===e[t.key]?"Done":e[t.key]})},t.key);if("storage_location"===t.key){var n;return(0,a.jsx)(r.agF,{className:"truncate",title:e[t.key],onClick:e=>{e.currentTarget.classList.toggle("expanded")},children:(null===(n=p[e.id])||void 0===n?void 0:n.storage_location)||""},t.key)}return"material"===t.key?(0,a.jsx)(r.agF,{children:(0,a.jsx)(r.rUS,{onClick:()=>{var t;k(!0),m((null===(t=p[e.id])||void 0===t?void 0:t.material)||[])},children:"More"})},t.key):"result"===t.key?(0,a.jsx)(r.agF,{children:(0,a.jsx)(r.rUS,{onClick:()=>{var t;k(!0),m((null===(t=p[e.id])||void 0===t?void 0:t.material)||[])},children:"view Detail"})},t.key):(0,a.jsx)(r.agF,{children:e[t.key]},t.key)}),(0,a.jsxs)(r.agF,{children:[(0,a.jsx)(r.JMr,{"aria-label":"Edit",disabled:!0,children:(0,a.jsx)(l.I8,{size:15})}),(0,a.jsx)(r.JMr,{"aria-label":"Delete",onClick:()=>handleDeleteRow(e.id),children:(0,a.jsx)(d.HG,{size:15})})]})]},n))})]}),(0,a.jsx)(r.tlE,{backwardText:"Previous page",forwardText:"Next page",itemsPerPageText:"Items per page:",page:i,pageNumberText:"Page Number",pageSize:h,pageSizes:[5,10,20,30,40,50],totalItems:n.length,onChange:e=>{let{page:t,pageSize:n}=e;c(t),f(n)}}),(0,a.jsx)(Modal_StocktakingResultModal,{material:x,isModalOpen:g,setModalOpen:k})]})};let f=[{key:"ref_id",header:"Ref ID"},{key:"type",header:"Type"},{key:"storage_location",header:"Storage Location"},{key:"operator",header:"Operator"},{key:"source",header:"Source"},{key:"status",header:"Status"},{key:"result",header:"Result"},{key:"create_time",header:"Create Time"}];var page=function(){let[e,t]=(0,o.useState)([]),[n,l]=(0,o.useState)({}),[d,h]=(0,o.useState)({ref_id:"",status:"",type:""}),onFormValueChange=e=>{let{id:t,value:n}=e.target;h(e=>({...e,[t]:n}))};return(0,o.useEffect)(()=>{(0,u.eN)().then(e=>t(e))},[n]),console.log(d),(0,a.jsxs)("div",{children:[(0,a.jsxs)(r.aGc,{children:[(0,a.jsx)(r.gN6,{children:(0,a.jsx)("a",{href:"/",children:"Home"})}),(0,a.jsx)(r.gN6,{href:"/operation/inbound",children:"Operation"}),(0,a.jsx)(r.gN6,{href:"/operation/stocktaking",children:"Stocktaking"})]}),(0,a.jsxs)("div",{className:"bx--col-lg-16 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(r.X6q,{className:"mt-2 text-[28px] font-normal",children:"Stocktaking"}),(0,a.jsx)(r.X6q,{className:"mt-1 text-sm",children:"Verify and adjust inventory accuracy"})]}),(0,a.jsx)(r.zxk,{href:"/operation/stocktaking/create",isExpressive:!0,size:"sm",renderIcon:s.mm,children:"Create a Stocktaking Order"})]}),(0,a.jsxs)("div",{className:"flex mt-20 space-x-4 items-end",children:[(0,a.jsx)(r.oil,{className:"flex-auto ",labelText:"Ref Id",id:"ref_id",placeholder:"Ref Id",value:d.ref_id,onChange:onFormValueChange}),(0,a.jsxs)(r.PhF,{className:"flex-auto",id:"type",defaultValue:"",labelText:"Stocktaking Type",value:d.type,onChange:onFormValueChange,required:!0,children:[(0,a.jsx)(r.QlF,{disabled:!0,hidden:!0,value:"",text:"Choose an option"}),(0,a.jsx)(r.QlF,{value:"cycle stock",text:"Cycle Stock"}),(0,a.jsx)(r.QlF,{value:"pipeline stock",text:"Pipeline Stock"}),(0,a.jsx)(r.QlF,{value:"mix stock",text:"Mix Stock"})]}),(0,a.jsxs)(r.PhF,{className:"flex-auto",id:"status",defaultValue:"",labelText:"Status",value:d.status,onChange:onFormValueChange,disabled:!0,required:!0,children:[(0,a.jsx)(r.QlF,{disabled:!0,hidden:!0,value:"",text:"Choose an option"}),(0,a.jsx)(r.QlF,{value:"Done",text:"Done"}),(0,a.jsx)(r.QlF,{value:"Executing",text:"Executing"}),(0,a.jsx)(r.QlF,{value:"To-do",text:"To-do"})]}),(0,a.jsx)(r.JMr,{"aria-label":"Search",onClick:()=>{let e=Object.entries(d).reduce((e,t)=>{let[n,a]=t;return""!==a&&(e[n]=a),e},{});Object.entries(e).length>0?(0,u._b)(e).then(e=>t(e)):(0,u.eN)().then(e=>t(e))},children:(0,a.jsx)(i.ol,{size:16})}),(0,a.jsx)(r.JMr,{"aria-label":"Remove Filters",onClick:()=>{(0,u.eN)().then(e=>t(e)),h({id:"",ref_id:"",status:"",type:""})},children:(0,a.jsx)(c.eL,{size:16})})]}),(0,a.jsx)("div",{className:"mt-12",children:(0,a.jsx)(Table_StocktakingTable,{headers:f,rows:e,setRefresh:l})})]})}},3180:function(){}},function(e){e.O(0,[788,668,107,971,472,744],function(){return e(e.s=2331)}),_N_E=e.O()}]);